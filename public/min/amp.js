try{let e,a,n,t,o,c,r,s,d;$("#rec-bar").hide(),$("#pay-option").hide(),$("#summary").hide(),$("#card-msg").hide(),$("#addrec-bar").show(),$("#card-details-bar").show();let l=$("#send-amount"),i=$("#take-amount");fetch("/rate",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.text())).then((r=>{function s(){switch(n){case"GBPtoNGN":t=r.GBPTONGN,o=l.val(),c=o*t,i.val(c.toFixed(2)),$("#rateValue").text(`NGN ${t}`),d();break;case"GBPtoGHS":t=r.GBPTOGHS,o=l.val(),c=o*t,i.val(c),$("#rateValue").text(`GHS ${t}`),d();break;case"GBPtoKEN":t=r.GBPTOKEN,o=l.val(),c=o*t,i.val(c),d()}}function d(){l.val()>1500?($("#btn-send").css("background-color","#8b8b8b"),$("#btn-send").prop("disabled",!0),$("#sendMessage").removeClass("showSendMessage")):l.val()>9.99?($("#btn-send").css("background-color","#009933"),$("#btn-send").prop("disabled",!1),$("#sendMessage").addClass("showSendMessage")):l.val()<=9.99&&($("#btn-send").css("background-color","#8b8b8b"),$("#btn-send").prop("disabled",!0),$("#sendMessage").addClass("showSendMessage"))}r=JSON.parse(r),$("#rateValue").text(`NGN ${r.GBPTONGN}`),$("#sendCurrency").on("change",(()=>{e=$("#sendCurrency").val(),a=$("#takeCurrency").val(),$("#baseFlag").attr("src",`https://flagcdn.com/${e.slice(0,2).toLowerCase()}.svg`),n=`${e}to${a}`,s()})),l.on("keyup",(()=>{e=$("#sendCurrency").val(),a=$("#takeCurrency").val(),n=`${e}to${a}`,s()})),$("#takeCurrency").on("change",(()=>{e=$("#sendCurrency").val(),a=$("#takeCurrency").val(),$("#takeFlag").attr("src",`https://flagcdn.com/${a.slice(0,2).toLowerCase()}.svg`),n=`${e}to${a}`,s()})),i.on("keyup",(()=>{e=$("#sendCurrency").val(),a=$("#takeCurrency").val(),n=`${e}to${a}`,s()}))})),$("#btn-send").on("click",(()=>{$("#exchange-bar").hide(),$("#tran").hide(),$("#rec-bar").show()})),$("#back").on("click",(()=>{$("#exchange-bar").show(),$("#tran").show(),$("#rec-bar").hide(),$("#pay-option").hide()}));let b=$(".receiver");for(let e=0;e<b.length;e++){let a=$(".acctName"),n=$(".acctNumber"),t=$(".bank"),o=$(".bankCode");$(b[e]).on("click",(()=>{s={accountName:$(a[e]).text(),accountNumber:$(n[e]).text(),bank:$(t[e]).text(),bankCode:$(o[e]).val()},$("#rec-bar").hide(),$("#pay-option").show()}))}$("#back-again").on("click",(()=>{$("#rec-bar").show(),$("#pay-option").hide()}));let u=$(".paymentOption");for(let n=0;n<u.length;n++){let l=$(".cardName"),i=$(".cardNumber");$(u[n]).on("click",(()=>{d={cardName:$(l[n]).text(),cardEndingNumber:$(i[n]).text()},r=Number($("#storedPromoCode").val()),convertedPromoValue=r*t,c=Number(c+convertedPromoValue),$("#pay-option").hide(),$("#summary").show(),$(".sendAmount").text(`${e} ${o}`),$(".takeAmount").text(`${a} ${c.toFixed(2)}`),$(".promoValue").text(r),$(".cAcctName").text(s.accountName),$(".cAcctNumber").text(s.accountNumber),$(".cBank").text(s.bank),$(".cCardName").text(d.cardName),$(".cCardNumber").text(d.cardEndingNumber)}))}$("#back-again").on("click",(()=>{$("#rec-bar").show(),$("#pay-option").hide()})),$("#back-last").on("click",(()=>{$("#summary").hide(),$("#pay-option").show()})),$("#send-money").on("click",(()=>{$("#send-money").prop("disabled",!0),$("#rec-bar").prop("disabled",!0),$("#send-money").text("process...");let l=String(4*Math.random()).slice(2);exchangeValues={currencyPair:n,sendCurrency:e,takeCurrency:a,sendAmount:100*o,takeAmount:c,promo:r,Base:t,receiverName:s.accountName,accountNumber:s.accountNumber,bankName:s.bank,bankCode:s.bankCode,nameOnPaymentCard:d.cardName,cardEnding:d.cardEndingNumber,ref:`w0s${l}`};let i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(exchangeValues)};fetch("/exchange",i).then((e=>e.json())).then((e=>{0==e?window.location.href="/fail":1==e&&(window.location.href="/success")}))}))}catch(e){console.log(e)}