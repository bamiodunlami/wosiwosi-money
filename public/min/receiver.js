$(document).ready((()=>{try{$("#addrec-bar").hide(),$("#card-details-bar").hide(),$("#account-msg").hide(),$(".rec-section").hide(),fetch("/load-bank",{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>e.text())).then((e=>{try{const t=JSON.parse(e),a=document.querySelector("#bankName");t.forEach((e=>{a.innerHTML+=`<option value="${e.code}">${e.name}</option>`})),$(".rec-section").show(),$("#spinner").hide()}catch(e){}})),$("#rec-add-btn").on("click",(()=>{const e=$("#rec-add-btn");e.text("Close"===e.text()?"Add receiver":"Close"),$("#addrec-bar").slideToggle()})),$("#confirm-btn").on("click",(()=>{$("#account-msg").text("Confirming...").removeClass("alert-success alert-danger").addClass("alert alert-light").show();const e={accountNumber:$("#accountNumber").val(),bankCode:$("#bankName option:selected").val()};fetch("/confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.text())).then((e=>{let t;try{t=JSON.parse(e)}catch(e){t={}}"success"===t.status?($("#account-msg").text(t.data.account_name).removeClass("alert-light alert-danger").addClass("alert alert-success").show(),$("#btn-addAccount").prop("disabled",!1)):$("#account-msg").text("Invalid Account Details").removeClass("alert-light alert-success").addClass("alert alert-danger").show()}))})),$("#btn-addAccount").on("click",(e=>{e.preventDefault();const t={acctNumber:$("#accountNumber").val(),acctName:$("#account-msg").text(),bankName:$("#bankName option:selected").val(),bankRealName:$("#bankName option:selected").html()};fetch("/addReceiver",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.json())).then((e=>{e.acknowledged&&(window.location.href="/receiver")}))})),$("#add-card").on("click",(()=>{const e=$("#add-card");e.text("Close"===e.text()?"Add Card":"Close"),$("#card-details-bar").slideToggle()})),$(".remove").each((function(e){$(this).on("click",(()=>{const t={accontDetails:$(`#acctNumber${e}`).text()};fetch("/removeReceiver",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.text())).then((e=>{"true"===e&&(window.location.href="/receiver")}))}))})),$(".removeCard").each((function(e){$(this).on("click",(()=>{const t={cardLastDigit:$(`#cardDigit${e}`).text().slice(12,16)};fetch("/removeCard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.text())).then((e=>{"true"===e&&(window.location.href="/receiver")}))}))}))}catch(e){}}));