try{$("#addrec-bar").hide(),$("#card-details-bar").hide(),$("#card-msg").hide(),$("#account-msg").hide(),fetch("/loadbank",{method:"POST",headers:{"Content-Type":"application/json"}}).then((e=>e.text())).then((e=>{try{let t=JSON.parse(e),a=document.querySelector("#bankName");for(let e=0;e<t.length;e++){let c=`<option value="${t[e].code}"> ${t[e].name}</option>`;a.innerHTML+=c}}catch(e){}})),$("#rec-add-btn").on("click",(()=>{"Close"==$("#rec-add-btn").text()?$("#rec-add-btn").text("Add receiver"):$("#rec-add-btn").text("Close"),$("#addrec-bar").slideToggle()})),$("#confirm-btn").on("click",(()=>{$("#account-msg").text("Confirming..."),$("#account-msg").addClass("alert alert-light"),$("#account-msg").show();let e={accountNumber:$("#accountNumber").val(),bankCode:$("#bankName option:selected").val()};fetch("/confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.text())).then((e=>{lookupResult=JSON.parse(e),"success"==JSON.parse(e).status?($("#account-msg").text(lookupResult.data.account_name),$("#account-msg").removeClass("alert-light"),$("#account-msg").removeClass("alert-danger"),$("#account-msg").addClass("alert alert-success"),$("#account-msg").show(),$("#btn-addAccount").prop("disabled",!1)):($("#account-msg").text("Invalid Account Details"),$("#account-msg").removeClass("alert-light"),$("#account-msg").removeClass("alert-success"),$("#account-msg").addClass("alert alert-danger"),$("#account-msg").show())}))})),$("#btn-addAccount").on("click",(e=>{e.preventDefault();let t={acctNumber:$("#accountNumber").val(),acctName:$("#account-msg").text(),bankName:$("#bankName option:selected").val(),bankRealName:$("#bankName option:selected").html()};fetch("/addReceiver",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.json())).then((e=>{1==e.acknowledged&&(window.location.href="/receiver")}))})),$("#add-card").on("click",(()=>{"Close"==$("#add-card").text()?$("#add-card").text("Add Card"):$("#add-card").text("Close"),$("#card-details-bar").slideToggle()}));let e=$("#expiry-date");$(e).on("keyup",(()=>{if(2==e.val().length){let t=e.val();e.val(t+"/")}})),$("#btn-addCard").on("click",(e=>{e.preventDefault();let t={cardName:$("#nameOnCard").val(),cardNumber:$("#cc-number").val(),expDate:$("#expiry-date").val(),cvv:$("#cvv").val()};fetch("/addCard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.text())).then((e=>{"false"==e?($("#card-msg").show(),$("#card-msg").text("Card Details incorrect")):window.location.reload()}))}));let t=$(".remove");for(let e=0;e<t.length;e++)$(t[e]).on("click",(()=>{let t={accontDetails:$(`#acctNumber${e}`).text()};fetch("/removeReceiver",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.text())).then((e=>{console.log(e),"true"==e&&(window.location.href="/receiver")}))}));let a=$(".removeCard");for(let e=0;e<a.length;e++)$(a[e]).on("click",(()=>{let t={cardLastDigit:$(`#cardDigit${e}`).text().slice(13,16),nameOnCard:$(`#cardName${e}`).text()};fetch("/removeCard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>e.text())).then((e=>{"true"==e&&(window.location.href="/receiver")}))}))}catch(e){}