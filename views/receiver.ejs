<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta tags for responsiveness and charset -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Account</title>
    <link rel="icon" type="image/png" href="images/icon.png" />

    <!-- Font Awesome for icons -->
    <script src="https://kit.fontawesome.com/cbf7b60e46.js" crossorigin="anonymous"></script>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous" />

    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;700&display=swap" rel="stylesheet" />

    <!-- Custom CSS -->
    <link href="style/dash.css" rel="stylesheet" />

    <!-- jQuery and Stripe JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script src="https://js.stripe.com/v3/"></script>
  </head>
  <body>
    <!-- Dashboard Container -->
    <div class="dashboard">
      <div class="container-fluid">
        <div class="row main-row">
          <!-- Navigation Bar Include -->
          <%- include("include/navdashboard") -%>

          <!-- Receiver Payment Methods Section -->
          <div class="col-md-10 col-sm-12 info-bar" id="receiver-bar">
            <!-- Receiver's Bank Details Section -->
            <div class="row rec-section" id="receiver-section">
              <!-- If no receiver, show message -->
              <% if (receiver.length == 0) { %>
              <div class="div rec-section-bar">
                <h6 class="text-center">No receiver added</h6>
                <!-- <p class="text-center notice">Kindly press the button to add receiver below</p> -->
              </div>
              <% } else { %>
              <h5 class="text-center">Receiver's Bank Details</h5>
              <div class="row">
                <% for (let i = 0; i < receiver.length; i++) { %>
                <div class="col-md-6" style="padding-bottom: 20px; padding-left: 0">
                  <div class="accoutn-details-bar" id="account-details-bar<%=i%>">
                    <h6 class="account-details">
                      <span class="account-details-value" id="nameOnAccount"><%= receiver[i].acctName %></span>
                    </h6>
                    <h6>
                      <span class="account-details-value account-number-value" id="acctNumber<%=i%>"><%= receiver[i].acctNumber %></span>
                    </h6>
                    <p class="account-details">
                      <span class="account-details-value"><%= receiver[i].bankRealName %></span>
                    </p>
                    <button class="btn btn-outline-danger btn-sm remove" id="remove<%=i%>">Remove</button>
                  </div>
                </div>
                <% } %>
              </div>
              <% } %>

              <!-- Add Receiver Form -->
              <div class="col-md-12 rec-form-bar" id="addrec-bar">
                <div class="col-md-12 add-rec">
                  <!-- spinner -->
                  <div class="d-flex justify-content-start">
                    <div class="spinner-grow" role="status" id="spinner">
                      <span class="visually-hidden">Loading...</span>
                    </div>
                  </div>
                  <!--  -->
                  <form method="POST">
                    <div class="mb-2">
                      <label>Account Number</label>
                      <input type="number" name="acctNumber" class="form-control inputs" id="accountNumber" required />
                    </div>
                    <div class="mb-2">
                      <label>Bank Name</label>
                      <select name="bankName" class="form-select" id="bankName" required></select>
                    </div>
                    <h6 id="account-msg" role="alert"></h6>
                    <a id="confirm-btn" class="btn btn-outline-dark btn-sm">Confirm</a>
                    <button type="submit" class="btn btn-success btn-sm btn-addAccount" id="btn-addAccount" disabled>Add Account</button>
                  </form>
                </div>
              </div>

              <!-- Button to show add receiver form -->
              <div class="add-rec-btn">
                <button id="rec-add-btn" class="btn btn-outline-dark btn-sm">Click to add receiver</button>
              </div>
            </div>

            <!-- Card Payment Methods Section -->
            <div class="row rec-section" id="card-section">
              <p class="text-center alert alert-warning" role="alert"><i class="fa-solid fa-lock fa-sm"></i> Details encrypted and 100% secured</p>
              <h5 class="text-center" id="card">Payment Methods</h5>
              <!-- If no card, show message -->
              <% if (card.length == 0) { %>
              <div class="div rec-section-bar">
                <h5 class="text-center notice">No card added</h5>
              </div>
              <% } else { %>
              <div class="row">
                <% for (let i = 0; i < card.length; i++) { %>

                <div class="col-md-6" style="padding-bottom: 20px; padding-left: 0">
                  <div class="accoutn-details-bar">
                    <h6 class="account-details">
                      <span class="account-details-value" id="cardName<%=i%>"><%= card[i].cardOwner %></span>
                    </h6>
                    <p class="account-details">
                      <span class="account-details-value" id="cardDigit<%=i%>">************<%= card[i].cardNumberEnding %></span>
                    </p>
                    <button class="btn btn-outline-danger btn-sm removeCard">Remove</button>
                  </div>
                </div>
                <% } %>
              </div>
              <% } %>

              <!-- Add Card Form -->
              <div class="col-md-12 rec-form-bar" id="addrec-bar">
                <div class="col-md-12" id="card-details-bar">
                  <form id="payment-form">
                    <div class="form-group">
                      <!-- Stripe Card Element -->
                      <div class="cardForm" id="card-element"></div>
                      <!-- Display form errors -->
                      <div id="card-errors" role="alert"></div>
                    </div>
                    <h6 class="card-msg alert alert-danger" role="alert"></h6>
                    <button type="submit" class="btn btn-success btn-md">Add Card</button>
                  </form>
                </div>
              </div>

              <!-- Button to show add card form -->
              <div class="add-rec-btn">
                <button id="add-card" class="btn btn-outline-dark btn-sm">Click to add card</button>
              </div>
            </div>
            <!-- End of Payment Methods Section -->
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <!-- Axios for HTTP requests -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- jQuery (latest) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <!-- Custom JS for receiver logic -->
    <script src="min/receiver.js" type="application/javascript"></script>
    <!-- Custom Stripe JS -->
    <script src="min/stripe.js"></script>
  </body>
</html>
